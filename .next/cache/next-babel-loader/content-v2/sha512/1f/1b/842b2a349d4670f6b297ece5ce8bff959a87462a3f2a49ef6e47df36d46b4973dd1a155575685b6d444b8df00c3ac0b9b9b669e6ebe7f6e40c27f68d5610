{"ast":null,"code":"import _regeneratorRuntime from \"/Users/might/Documents/projects/mine/nextjs/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/might/Documents/projects/mine/nextjs/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/might/Documents/projects/mine/nextjs/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/might/Documents/projects/mine/nextjs/src/pages/_app.tsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect } from 'react';\nimport { ToastContainer } from 'react-toastify';\nimport { SWRConfig } from 'swr';\nimport ReactModal from 'react-modal';\nimport { serverSideTranslations } from 'next-i18next/serverSideTranslations';\nimport { ApolloProvider } from '@apollo/client/react';\nimport { appWithTranslation } from 'next-i18next';\nimport { useRouter } from 'next/router';\nimport { wrapper } from '@components/Store';\nimport { bindUser } from '@redux/user.redux';\nimport { getCookieByName } from '@helpers/cookie.helper';\nimport ReduxConfirmModal from '@containers/modals/ReduxConfirmModal';\nimport { apolloClient } from '@helpers/apollo.helper';\nimport { CONFIG } from '@constants/config.constants';\nimport { PATH_SIGN_IN } from '@constants/routes.constants';\nimport '@assets/scss/global.scss';\nimport 'react-toastify/dist/ReactToastify.css';\nReactModal.setAppElement('#__next');\n\nvar redirect = function redirect(res, path) {\n  if (typeof res.writeHead === 'function' && typeof res.end === 'function') {\n    res.writeHead(302, {\n      Location: path\n    });\n    res.end();\n  }\n};\n\nvar MyApp = function MyApp(_ref) {\n  _s();\n\n  var Component = _ref.Component,\n      pageProps = _ref.pageProps;\n  var router = useRouter();\n  useEffect(function () {\n    var locale = router.locale,\n        pathname = router.pathname;\n    var lang = getCookieByName('NEXT_LOCALE') || CONFIG.I18N_CONFIG.i18n.defaultLocale;\n\n    if (lang !== locale) {\n      // eslint-disable-next-line @typescript-eslint/no-floating-promises\n      router.push(pathname, pathname, {\n        locale: lang\n      });\n    }\n  }, []);\n  return /*#__PURE__*/_jsxDEV(SWRConfig, {\n    value: {\n      revalidateOnFocus: false\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"script\", {\n      src: \"https://static.geetest.com/static/tools/gt.js\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(ApolloProvider, {\n      client: apolloClient,\n      children: /*#__PURE__*/_jsxDEV(Component, _objectSpread({}, pageProps), void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(ReduxConfirmModal, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(ToastContainer, {\n      position: \"top-right\",\n      autoClose: 3000,\n      hideProgressBar: false,\n      newestOnTop: false,\n      closeOnClick: true,\n      rtl: false,\n      pauseOnFocusLoss: true,\n      draggable: true,\n      pauseOnHover: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 44,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(MyApp, \"vQduR7x+OPXj6PSmJyFnf+hU7bg=\", false, function () {\n  return [useRouter];\n});\n\n_c = MyApp;\nMyApp.getInitialProps = wrapper.getInitialAppProps(function (store) {\n  return /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref2) {\n      var _ctx$req, _ctx$req$cookies, _ctx$req2;\n\n      var Component, ctx, locale;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              Component = _ref2.Component, ctx = _ref2.ctx;\n              locale = ((_ctx$req = ctx.req) === null || _ctx$req === void 0 ? void 0 : (_ctx$req$cookies = _ctx$req.cookies) === null || _ctx$req$cookies === void 0 ? void 0 : _ctx$req$cookies.NEXT_LOCALE) || CONFIG.I18N_CONFIG.i18n.defaultLocale;\n\n              if (!(ctx.res && !ctx.pathname.includes('/_error'))) {\n                _context.next = 8;\n                break;\n              }\n\n              _context.next = 5;\n              return store.dispatch(bindUser());\n\n            case 5:\n              if (!(!Component.allowWithoutAuth && !store.getState().user)) {\n                _context.next = 8;\n                break;\n              }\n\n              redirect(ctx.res, PATH_SIGN_IN);\n              return _context.abrupt(\"return\", {\n                pageProps: {}\n              });\n\n            case 8:\n              _context.t0 = _objectSpread;\n              _context.t1 = _objectSpread;\n              _context.t2 = {};\n\n              if (!Component.getInitialProps) {\n                _context.next = 17;\n                break;\n              }\n\n              _context.next = 14;\n              return Component.getInitialProps(_objectSpread(_objectSpread({}, ctx), {}, {\n                store: store\n              }));\n\n            case 14:\n              _context.t3 = _context.sent;\n              _context.next = 18;\n              break;\n\n            case 17:\n              _context.t3 = {};\n\n            case 18:\n              _context.t4 = _context.t3;\n              _context.t5 = (0, _context.t1)(_context.t2, _context.t4);\n              _context.t6 = {};\n              _context.t7 = {\n                pathname: ctx.pathname,\n                user: store.getState().user\n              };\n\n              if (!((_ctx$req2 = ctx.req) !== null && _ctx$req2 !== void 0 && _ctx$req2.cookies)) {\n                _context.next = 28;\n                break;\n              }\n\n              _context.next = 25;\n              return serverSideTranslations(locale, ['common'], CONFIG.I18N_CONFIG);\n\n            case 25:\n              _context.t8 = _context.sent;\n              _context.next = 29;\n              break;\n\n            case 28:\n              _context.t8 = {};\n\n            case 29:\n              _context.t9 = _context.t8;\n              _context.t10 = (0, _context.t0)(_context.t5, _context.t6, _context.t7, _context.t9);\n              return _context.abrupt(\"return\", {\n                pageProps: _context.t10\n              });\n\n            case 32:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function (_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n});\nexport default _c3 = wrapper.withRedux(_c2 = appWithTranslation(MyApp));\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"MyApp\");\n$RefreshReg$(_c2, \"%default%$wrapper.withRedux\");\n$RefreshReg$(_c3, \"%default%\");","map":{"version":3,"sources":["/Users/might/Documents/projects/mine/nextjs/src/pages/_app.tsx"],"names":["React","useEffect","ToastContainer","SWRConfig","ReactModal","serverSideTranslations","ApolloProvider","appWithTranslation","useRouter","wrapper","bindUser","getCookieByName","ReduxConfirmModal","apolloClient","CONFIG","PATH_SIGN_IN","setAppElement","redirect","res","path","writeHead","end","Location","MyApp","Component","pageProps","router","locale","pathname","lang","I18N_CONFIG","i18n","defaultLocale","push","revalidateOnFocus","getInitialProps","getInitialAppProps","store","ctx","req","cookies","NEXT_LOCALE","includes","dispatch","allowWithoutAuth","getState","user","withRedux"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport { ToastContainer } from 'react-toastify';\nimport { ServerResponse } from 'http';\nimport { SWRConfig } from 'swr';\nimport ReactModal from 'react-modal';\nimport { AppProps } from 'next/app';\nimport { serverSideTranslations } from 'next-i18next/serverSideTranslations';\nimport { ApolloProvider } from '@apollo/client/react';\nimport { appWithTranslation } from 'next-i18next';\nimport { useRouter } from 'next/router';\n\nimport { wrapper } from '@components/Store';\nimport { bindUser } from '@redux/user.redux';\nimport { getCookieByName } from '@helpers/cookie.helper';\nimport ReduxConfirmModal from '@containers/modals/ReduxConfirmModal';\nimport { apolloClient } from '@helpers/apollo.helper';\nimport { CONFIG } from '@constants/config.constants';\nimport { PATH_SIGN_IN } from '@constants/routes.constants';\nimport { Page } from '../types/next.types';\nimport '@assets/scss/global.scss';\nimport 'react-toastify/dist/ReactToastify.css';\n\nReactModal.setAppElement('#__next');\nconst redirect = (res: ServerResponse, path: string) => {\n  if (typeof res.writeHead === 'function' && typeof res.end === 'function') {\n    res.writeHead(302, { Location: path });\n    res.end();\n  }\n};\n\nconst MyApp = ({ Component, pageProps }: AppProps) => {\n  const router = useRouter();\n\n  useEffect(() => {\n    const { locale, pathname } = router;\n    const lang = getCookieByName('NEXT_LOCALE') || CONFIG.I18N_CONFIG.i18n.defaultLocale;\n    if (lang !== locale) {\n      // eslint-disable-next-line @typescript-eslint/no-floating-promises\n      router.push(pathname, pathname, { locale: lang });\n    }\n  }, []);\n\n  return (\n    <SWRConfig\n      value={{\n        revalidateOnFocus: false,\n      }}\n    >\n      <script src=\"https://static.geetest.com/static/tools/gt.js\" />\n      <ApolloProvider client={apolloClient}>\n        <Component {...pageProps} />\n      </ApolloProvider>\n      <ReduxConfirmModal />\n      <ToastContainer\n        position=\"top-right\"\n        autoClose={3000}\n        hideProgressBar={false}\n        newestOnTop={false}\n        closeOnClick\n        rtl={false}\n        pauseOnFocusLoss\n        draggable\n        pauseOnHover\n      />\n    </SWRConfig>\n  );\n};\n\nMyApp.getInitialProps = wrapper.getInitialAppProps((store) => async ({ Component, ctx }) => {\n  const locale = (ctx.req as any)?.cookies?.NEXT_LOCALE || CONFIG.I18N_CONFIG.i18n.defaultLocale;\n  if (ctx.res && !ctx.pathname.includes('/_error')) {\n    await store.dispatch(bindUser());\n    if (!(Component as Page).allowWithoutAuth && !store.getState().user) {\n      redirect(ctx.res, PATH_SIGN_IN);\n      return { pageProps: {} };\n    }\n  }\n\n  return {\n    pageProps: {\n      ...(Component.getInitialProps ? await Component.getInitialProps({ ...ctx, store }) : {}),\n      pathname: ctx.pathname,\n      user: store.getState().user,\n      ...((ctx.req as any)?.cookies\n        ? await serverSideTranslations(locale, ['common'], CONFIG.I18N_CONFIG) : {}\n      ),\n    },\n  };\n});\n\nexport default wrapper.withRedux(appWithTranslation(MyApp));\n"]},"metadata":{},"sourceType":"module"}