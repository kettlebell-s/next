{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/might/Documents/projects/mine/nextjs/src/pages/_app.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useEffect } from 'react';\nimport { ToastContainer } from 'react-toastify';\nimport { SWRConfig } from 'swr';\nimport ReactModal from 'react-modal';\nimport { serverSideTranslations } from 'next-i18next/serverSideTranslations';\nimport { ApolloProvider } from '@apollo/client/react';\nimport { appWithTranslation } from 'next-i18next';\nimport { useRouter } from 'next/router';\nimport { wrapper } from '@components/Store';\nimport { bindUser } from '@redux/user.redux';\nimport { getCookieByName } from '@helpers/cookie.helper';\nimport ReduxConfirmModal from '@containers/modals/ReduxConfirmModal';\nimport { apolloClient } from '@helpers/apollo.helper';\nimport { CONFIG } from '@constants/config.constants';\nimport { PATH_SIGN_IN } from '@constants/routes.constants';\nimport '@assets/scss/global.scss';\nimport 'react-toastify/dist/ReactToastify.css';\nReactModal.setAppElement('#__next');\n\nconst redirect = (res, path) => {\n  if (typeof res.writeHead === 'function' && typeof res.end === 'function') {\n    res.writeHead(302, {\n      Location: path\n    });\n    res.end();\n  }\n};\n\nconst MyApp = ({\n  Component,\n  pageProps\n}) => {\n  const router = useRouter();\n  useEffect(() => {\n    const {\n      locale,\n      pathname\n    } = router;\n    const lang = getCookieByName('NEXT_LOCALE') || CONFIG.I18N_CONFIG.i18n.defaultLocale;\n\n    if (lang !== locale) {\n      // eslint-disable-next-line @typescript-eslint/no-floating-promises\n      router.push(pathname, pathname, {\n        locale: lang\n      });\n    }\n  }, []);\n  return /*#__PURE__*/_jsxDEV(SWRConfig, {\n    value: {\n      revalidateOnFocus: false\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"script\", {\n      src: \"https://static.geetest.com/static/tools/gt.js\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ApolloProvider, {\n      client: apolloClient,\n      children: /*#__PURE__*/_jsxDEV(Component, _objectSpread({}, pageProps), void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 51,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ReduxConfirmModal, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ToastContainer, {\n      position: \"top-right\",\n      autoClose: 3000,\n      hideProgressBar: false,\n      newestOnTop: false,\n      closeOnClick: true,\n      rtl: false,\n      pauseOnFocusLoss: true,\n      draggable: true,\n      pauseOnHover: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 44,\n    columnNumber: 5\n  }, this);\n};\n\nMyApp.getInitialProps = wrapper.getInitialAppProps(store => async ({\n  Component,\n  ctx\n}) => {\n  var _ctx$req, _ctx$req$cookies, _ctx$req2;\n\n  const locale = ((_ctx$req = ctx.req) === null || _ctx$req === void 0 ? void 0 : (_ctx$req$cookies = _ctx$req.cookies) === null || _ctx$req$cookies === void 0 ? void 0 : _ctx$req$cookies.NEXT_LOCALE) || CONFIG.I18N_CONFIG.i18n.defaultLocale;\n\n  if (ctx.res && !ctx.pathname.includes('/_error')) {\n    await store.dispatch(bindUser());\n\n    if (!Component.allowWithoutAuth && !store.getState().user) {\n      redirect(ctx.res, PATH_SIGN_IN);\n      return {\n        pageProps: {}\n      };\n    }\n  }\n\n  return {\n    pageProps: _objectSpread(_objectSpread({}, Component.getInitialProps ? await Component.getInitialProps(_objectSpread(_objectSpread({}, ctx), {}, {\n      store\n    })) : {}), {}, {\n      pathname: ctx.pathname,\n      user: store.getState().user\n    }, (_ctx$req2 = ctx.req) !== null && _ctx$req2 !== void 0 && _ctx$req2.cookies ? await serverSideTranslations(locale, ['common'], CONFIG.I18N_CONFIG) : {})\n  };\n});\nexport default wrapper.withRedux(appWithTranslation(MyApp));","map":{"version":3,"sources":["/Users/might/Documents/projects/mine/nextjs/src/pages/_app.tsx"],"names":["React","useEffect","ToastContainer","SWRConfig","ReactModal","serverSideTranslations","ApolloProvider","appWithTranslation","useRouter","wrapper","bindUser","getCookieByName","ReduxConfirmModal","apolloClient","CONFIG","PATH_SIGN_IN","setAppElement","redirect","res","path","writeHead","end","Location","MyApp","Component","pageProps","router","locale","pathname","lang","I18N_CONFIG","i18n","defaultLocale","push","revalidateOnFocus","getInitialProps","getInitialAppProps","store","ctx","req","cookies","NEXT_LOCALE","includes","dispatch","allowWithoutAuth","getState","user","withRedux"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport { ToastContainer } from 'react-toastify';\nimport { ServerResponse } from 'http';\nimport { SWRConfig } from 'swr';\nimport ReactModal from 'react-modal';\nimport { AppProps } from 'next/app';\nimport { serverSideTranslations } from 'next-i18next/serverSideTranslations';\nimport { ApolloProvider } from '@apollo/client/react';\nimport { appWithTranslation } from 'next-i18next';\nimport { useRouter } from 'next/router';\n\nimport { wrapper } from '@components/Store';\nimport { bindUser } from '@redux/user.redux';\nimport { getCookieByName } from '@helpers/cookie.helper';\nimport ReduxConfirmModal from '@containers/modals/ReduxConfirmModal';\nimport { apolloClient } from '@helpers/apollo.helper';\nimport { CONFIG } from '@constants/config.constants';\nimport { PATH_SIGN_IN } from '@constants/routes.constants';\nimport { Page } from '../types/next.types';\nimport '@assets/scss/global.scss';\nimport 'react-toastify/dist/ReactToastify.css';\n\nReactModal.setAppElement('#__next');\nconst redirect = (res: ServerResponse, path: string) => {\n  if (typeof res.writeHead === 'function' && typeof res.end === 'function') {\n    res.writeHead(302, { Location: path });\n    res.end();\n  }\n};\n\nconst MyApp = ({ Component, pageProps }: AppProps) => {\n  const router = useRouter();\n\n  useEffect(() => {\n    const { locale, pathname } = router;\n    const lang = getCookieByName('NEXT_LOCALE') || CONFIG.I18N_CONFIG.i18n.defaultLocale;\n    if (lang !== locale) {\n      // eslint-disable-next-line @typescript-eslint/no-floating-promises\n      router.push(pathname, pathname, { locale: lang });\n    }\n  }, []);\n\n  return (\n    <SWRConfig\n      value={{\n        revalidateOnFocus: false,\n      }}\n    >\n      <script src=\"https://static.geetest.com/static/tools/gt.js\" />\n      <ApolloProvider client={apolloClient}>\n        <Component {...pageProps} />\n      </ApolloProvider>\n      <ReduxConfirmModal />\n      <ToastContainer\n        position=\"top-right\"\n        autoClose={3000}\n        hideProgressBar={false}\n        newestOnTop={false}\n        closeOnClick\n        rtl={false}\n        pauseOnFocusLoss\n        draggable\n        pauseOnHover\n      />\n    </SWRConfig>\n  );\n};\n\nMyApp.getInitialProps = wrapper.getInitialAppProps((store) => async ({ Component, ctx }) => {\n  const locale = (ctx.req as any)?.cookies?.NEXT_LOCALE || CONFIG.I18N_CONFIG.i18n.defaultLocale;\n  if (ctx.res && !ctx.pathname.includes('/_error')) {\n    await store.dispatch(bindUser());\n    if (!(Component as Page).allowWithoutAuth && !store.getState().user) {\n      redirect(ctx.res, PATH_SIGN_IN);\n      return { pageProps: {} };\n    }\n  }\n\n  return {\n    pageProps: {\n      ...(Component.getInitialProps ? await Component.getInitialProps({ ...ctx, store }) : {}),\n      pathname: ctx.pathname,\n      user: store.getState().user,\n      ...((ctx.req as any)?.cookies\n        ? await serverSideTranslations(locale, ['common'], CONFIG.I18N_CONFIG) : {}\n      ),\n    },\n  };\n});\n\nexport default wrapper.withRedux(appWithTranslation(MyApp));\n"]},"metadata":{},"sourceType":"module"}